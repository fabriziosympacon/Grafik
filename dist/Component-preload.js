//@ui5-bundle sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/Component-preload.js
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/Component-preload", [],function(){"use strict";return{}});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/Component", ["sap/ui/core/UIComponent"],function(e){"use strict";return e.extend("sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing.Component",{metadata:{rootView:{viewName:"sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing.NetworkGraph",type:"XML",async:true},dependencies:{libs:["sap.m","sap.suite.ui.commons"]},config:{sample:{stretch:true,files:["NetworkGraph.view.xml","NetworkGraph.controller.js","graph.json"]}}}})});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/NetworkGraph.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/OverflowToolbarButton","sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/DataLoader","sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/datatable","sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/vorgaengerLoader","sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/VorgaengerTableUtils"],function(e,t,o,a,i,s,r){"use strict";return e.extend("sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing.NetworkGraph",{onInit:function(){var e=this.getView(),a=e.byId("graph"),s=new t({isLoading:true,data:{}});e.setModel(s);a.setBusy(true);var r=new t({isLoading:true,tableData:[],vorgaengerData:[]});e.setModel(r,"dataModel");this.baseUrl=window.location.hostname==="localhost"?"http://localhost:3000/api/":"https://ui5-mongodb-project.vercel.app/api/";i.loadData(r,null,false,this.baseUrl,function(e){r.setProperty("/tableData",e);r.setProperty("/isLoading",false);r.refresh(true)});a.getToolbar().addContent(new o({icon:"sap-icon://collapse-all",tooltip:"Collapse all nodes",type:"Transparent",press:this.hideAllNodes.bind(this)}));a.attachSelectionChange(this.selectionChange,this);var n=e.byId("dataTable");n.attachRowSelectionChange(this.onRowSelectionChange,this)},onRowSelectionChange:function(e){var t=e.getParameter("rowContext");if(t){var o=t.getObject();console.log("Selected row data:",o);var i=o.Archivierungsobjekt;var r=this.baseUrl+"vorgaenger?archivierungsobjekt="+i;console.log("Constructed URL:",r);s.loadVorgaengerData(r,this);a.loadGraphData(this.getView().getModel(),this.getView().byId("graph"),r,this.showAllNodes.bind(this))}},destroyGraph:function(){var e=this.getView().byId("graph");e.destroyNodes();e.destroyLines()},showAllNodes:function(){var e=this.getView().byId("graph");e.getNodes().forEach(function(e){e.setVisible(true)})},hideAllNodes:function(){var e=this.getView().byId("graph");e.getNodes().forEach(function(e){e.setVisible(false)})},selectionChange:function(e){console.log("Selection changed:",e.getParameter("items"))},replaceGraphData:function(e,t){var o=this.getView().byId("graph");this.destroyGraph();console.log("Aktuelle Nodes vor Einfügen:",o.getNodes().map(e=>e.getKey()));if(Array.isArray(e)){e.forEach(function(e){var t=o.getNodes().find(t=>t.getKey()===e.key);if(!t){var a=new sap.suite.ui.commons.networkgraph.Node({key:e.key,title:e.title,shape:"Box",attributes:e.V_DE?[new sap.suite.ui.commons.networkgraph.ElementAttribute({label:e.V_DE})]:[]});o.addNode(a)}else{console.warn("Doppelter Node verhindert:",e.key)}})}else{console.error("nodesArray ist nicht korrekt")}if(Array.isArray(t)){t.forEach(function(e){o.addLine(new sap.suite.ui.commons.networkgraph.Line(e))})}else{console.error("linesArray ist nicht korrekt")}o.setBusy(false)},onVorgaengerTableSelectionChange:function(e){var t=r.onVorgaengerTableSelectionChange(e,this);if(t&&t.nodes&&t.lines){var o=t.nodes;var a=t.lines;console.log("Filtered Nodes:",o);console.log("Filtered Lines:",a);this.replaceGraphData(o,a)}}})});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/DataLoader", ["sap/ui/model/json/JSONModel","sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/DataTransformer"],function(a,e){"use strict";return{loadGraphData:function(a,s,t,r){a.loadData(t,null,true).then(()=>{var t=a.getData();console.log("Full API Response:",t);if(t&&Array.isArray(t)&&t.length>0){try{var o=e.transformApiDataToGraphData(t);console.log("Transformed Combined Data:",o);a.setData({isLoading:false,data:o.graphData});a.setProperty("/vorgaengerData",o.tableData);a.refresh(true);s.setBusy(false);s.invalidate();s.attachBeforeLayouting(r)}catch(e){console.error("Error transforming data:",e);a.setData({isLoading:false});s.setBusy(false)}}else{console.error("Invalid or empty API response");a.setData({isLoading:false});s.setBusy(false)}}).catch(e=>{console.error("Error loading data:",e);a.setData({isLoading:false});s.setBusy(false)})}}});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/DataTransformer", [],function(){"use strict";return{transformApiDataToGraphData:function(r){console.log("API Response in DataTransformer:",r);var e={nodes:[],lines:[]};var a=[];var n={};if(!Array.isArray(r)){console.error("Invalid API response: Expected an array.",r);return{graphData:e,tableData:a}}r.forEach(function(r){if(!r||!r.vorgaengerHierarchy){console.error("Invalid data in API object:",r);return}var t=r.Archivierungsobjekt;var o="VORG_"+t;if(!n[o]){n[o]={key:o,title:t,attributes:[{label:r.O_DE}]};e.nodes.push(n[o]);a.push({Vorgaenger:t,V_DE:r.O_DE,V_EN:r.O_EN,key:o})}r.vorgaengerHierarchy.forEach(function(r){if(!r)return;var t="VORG_"+(r.Vorgaenger||r.Archivierungsobjekt);var i="VORG_"+r.Archivierungsobjekt;if(!n[t]){n[t]={key:t,title:r.Vorgaenger||r.Archivierungsobjekt,attributes:[{label:r.V_DE||r.O_DE}]};e.nodes.push(n[t]);a.push({Vorgaenger:r.Vorgaenger||r.Archivierungsobjekt,V_DE:r.V_DE||r.O_DE,V_EN:r.V_EN||r.O_EN,key:t})}if(!n[i]){n[i]={key:i,title:r.Archivierungsobjekt,attributes:[{label:r.O_DE}]};e.nodes.push(n[i]);a.push({Vorgaenger:r.Archivierungsobjekt,V_DE:r.O_DE,V_EN:r.O_EN,key:i})}if(t!==i){var s=e.lines.some(function(r){return r.from===t&&r.to===i});if(!s){e.lines.push({from:t,to:i})}}if(r.level===0&&n[i]&&!e.lines.some(r=>r.from===i&&r.to===o)){e.lines.push({from:i,to:o})}})});a.sort(function(r,e){var a=r.Vorgaenger.toUpperCase();var n=e.Vorgaenger.toUpperCase();if(a<n){return-1}if(a>n){return 1}return 0});console.log("Final Combined Data:",{graphData:e,tableData:a});return{graphData:e,tableData:a}}}});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/GraphReconnectionUtils", [],function(){"use strict";return{reconnectGraphLines:function(o,r){var t={};o.nodes.forEach(function(o){t[o.key]=o});var n=[];var e=[];var f=r;var i=f.getView().getModel("dataModel").getProperty("/originalGraphData/nodes");i.forEach(function(o){if(!t[o.key]){e.push(o.key)}});e.forEach(function(o){var r=[];var e=[];var i=f.getView().getModel("dataModel").getProperty("/originalGraphData/lines");i.forEach(function(t){if(t.to===o){r.push(t.from)}if(t.from===o){e.push(t.to)}});r.forEach(function(o){e.forEach(function(r){if(t[o]&&t[r]){n.push({from:o,to:r})}})})});n.forEach(function(r){if(!o.lines.some(function(o){return o.from===r.from&&o.to===r.to})){o.lines.push(r)}});o.lines=o.lines.filter(function(o){return t[o.from]&&t[o.to]});if(e.length>1){var a=f.getView().getModel("dataModel").getProperty("/originalGraphData/lines");a.forEach(function(r){if(e.includes(r.from)&&e.includes(r.to)){var n=null;var f=null;a.forEach(function(o){if(o.to===r.from&&t[o.from]){n=o.from}if(o.from===r.to&&t[o.to]){f=o.to}});if(n&&f){if(!o.lines.some(o=>o.from===n&&o.to===f)){o.lines.push({from:n,to:f})}}}})}}}});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/VorgaengerTableUtils", ["sap/base/util/deepClone","sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/GraphReconnectionUtils"],function(e,n){"use strict";return{onVorgaengerTableSelectionChange:function(r,o){console.log("onVorgaengerTableSelectionChange called");var t=r.getSource();var a=t.getSelectedIndices();var i=o.getView().getModel("dataModel");var l=i.getProperty("/vorgaengerData");var s=i.getProperty("/originalGraphData");var c=a.map(function(e){return l[e].key});console.log("aSelectedKeys:",c);var d=e(s);d.nodes=d.nodes.filter(function(e){return!c.includes(e.key)});console.log("oFilteredGraphData.nodes (after filter):",d.nodes);d.nodes.forEach(function(e){var n=l.find(function(n){return n.key===e.key});if(n){e.V_DE=n.V_DE}});console.log("oFilteredGraphData.nodes (after filter and V_DE addition):",d.nodes);d.lines=d.lines.filter(function(e){return!c.includes(e.from)&&!c.includes(e.to)});console.log("oFilteredGraphData.lines (after filter):",d.lines);n.reconnectGraphLines(d,o);i.setProperty("/graphData",d);console.log("graphData lines after reconnection:",d.lines);o.getView().byId("graph").rerender();return d}}});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/dataTable", ["sap/m/MessageToast"],function(e){"use strict";function t(e,t){let r=[];let o=new Set;e.forEach(e=>{if(!o.has(e[t])){o.add(e[t]);r.push(e)}});return r}function r(e,t){return e.sort((e,r)=>{if(e[t]<r[t])return-1;if(e[t]>r[t])return 1;return 0})}function o(o,s,a,n,i){if(!o){e.show("Data model is not set");return}o.setProperty("/selectedObject",null);var u=n+"data";var l=[];if(a){l.push("groupByArchivierungsobjekt=true")}if(s){console.log("Filter for data:",s);l.push("filter="+encodeURIComponent(JSON.stringify(s)))}u+="?"+l.join("&");console.log("Request URL:",u);$.ajax({url:u,method:"GET",success:function(e){console.log("Data loaded successfully:",e);o.setProperty("/data",[]);let a=t(e,"Archivierungsobjekt");console.log("Data after removing duplicates:",a);a=r(a,"Archivierungsobjekt");o.setProperty("/data",a);if(s&&e.length>0){var n=e[0];o.setProperty("/selectedObject",n);o.setProperty("/vorgaengerPanelHeader","Vorgängerobjekt: "+n.Archivierungsobjekt)}if(i){i(e)}},error:function(t,r,o){console.error(`Failed to load data (${t.status}): ${t.responseText}`);e.show("Failed to load data")}})}return{loadData:o}});
sap.ui.predefine("sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/vorgaengerLoader", ["sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/utils/DataTransformer"],function(r){"use strict";return{loadVorgaengerData:function(a,e){fetch(a).then(r=>{console.log("API response object:",r);console.log(a);return r.json()}).then(a=>{console.log("API response for vorgaenger:",a);var o=e.getView().getModel("dataModel");if(!Array.isArray(a)){console.error("Invalid API response: Expected an array.",a);o.setProperty("/vorgaengerData",[]);o.refresh(true);return}var t=r.transformApiDataToGraphData(a);o.setProperty("/vorgaengerData",t.tableData);o.setProperty("/graphData",t.graphData);o.refresh(true);console.log("✅ vorgaengerData updated:",o.getProperty("/vorgaengerData"));console.log("✅ graphData updated:",o.getProperty("/graphData"));if(e&&typeof e.callback==="function"){e.callback(a)}o.setProperty("/originalGraphData",t.graphData)}).catch(r=>console.error("❌ Error fetching vorgaenger data:",r))}}});
sap.ui.require.preload({
	"sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/NetworkGraph.view.xml":'<mvc:View\n    controllerName="sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing.NetworkGraph"\n    xmlns="sap.suite.ui.commons.networkgraph"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns:m="sap.m"\n    xmlns:table="sap.ui.table"><m:Panel id="tablePanel" headerText="Archivierungsobjekte" expandable="true" expanded="true"><table:Table id="dataTable" rows="{dataModel>/data}" visibleRowCount="5" \n                     selectionMode="Single" selectionBehavior="Row" \n                     rowSelectionChange="onSelectionChange"><table:columns><table:Column><m:Label text="Archivierungsobjekt"/><table:template><m:Text text="{dataModel>Archivierungsobjekt}"/></table:template></table:Column><table:Column visible="{dataModel>/showEN}"><m:Label text="Bezeichnung EN"/><table:template><m:Text text="{dataModel>O_EN}"/></table:template></table:Column><table:Column visible="{dataModel>/showDE}"><m:Label text="Bezeichnung DE"/><table:template><m:Text text="{dataModel>O_DE}"/></table:template></table:Column></table:columns></table:Table></m:Panel><m:Panel id="vorgaengerPanel"\n             headerText="Ausschluss Vorgängerobjekte wählen"\n             expandable="true"\n             expanded="false"><table:Table id="vorgaengerTable"\n                     rows="{dataModel>/vorgaengerData}"\n                     visibleRowCount="5"\n                     selectionMode="MultiToggle" \n                     selectionBehavior="Row"\n                     rowSelectionChange="onVorgaengerTableSelectionChange"><table:columns><table:Column><m:Label text="Vorgänger"/><table:template><m:Text text="{dataModel>Vorgaenger}"/></table:template></table:Column><table:Column visible="{dataModel>/showEN}"><m:Label text="Bezeichnung EN"/><table:template><m:Text text="{dataModel>V_EN}"/></table:template></table:Column><table:Column visible="{dataModel>/showDE}"><m:Label text="Bezeichnung DE"/><table:template><m:Text text="{dataModel>V_DE}"/></table:template></table:Column></table:columns></table:Table></m:Panel><m:Panel id="graphPanel" headerText="Archivierungsläufe" expandable="true" expanded="true" visible="true"><Graph enableWheelZoom="false" id="graph" nodes="{/data/nodes}" lines="{/data/lines}"><nodes><Node key="{key}" title="{title}" icon="{icon}" attributes="{path:\'attributes\', templateShareable:true}" showActionLinksButton="false" showDetailButton="false" showExpandButton="false" shape="Box"><attributes><ElementAttribute label="{label}" value="{value}"/></attributes></Node></nodes><lines><Line from="{from}" to="{to}"/></lines></Graph></m:Panel></mvc:View>\n',
	"sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/index.js":function(){
sap.ui.require(["sap/m/Shell","sap/m/App","sap/m/Page","sap/ui/core/ComponentContainer","sap/ui/core/Core"],function(e,i,n,a,t){"use strict";t.attachInit(function(){new e({app:new i({pages:[new n({title:"Bidirectional Custom Collapsing",enableScrolling:false,content:[new a({height:"100%",name:"sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing",settings:{id:"sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing"}})]})]})}).placeAt("content")})});
},
	"sap/suite/ui/commons/sample/NetworkGraphBidirectionalCollapsing/manifest.json":'{"_version":"1.12.0","sap.app":{"id":"sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing","type":"application","title":"Network Graph Sample","description":"Sample application demonstrating the Network Graph control with bidirectional collapsing.","applicationVersion":{"version":"1.0.0"}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"contentDensities":{"compact":true,"cozy":true},"rootView":{"viewName":"sap.suite.ui.commons.sample.NetworkGraphBidirectionalCollapsing.NetworkGraph","type":"XML","async":true,"id":"networkGraph"},"dependencies":{"minUI5Version":"1.60.0","libs":{"sap.m":{},"sap.ui.core":{},"sap.suite.ui.commons":{}}},"models":{"":{"type":"sap.ui.model.json.JSONModel","uri":"graph.json"}}}}'
});
//# sourceMappingURL=Component-preload.js.map
